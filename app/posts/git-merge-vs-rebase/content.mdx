import { Figure } from "../../components/posts";
import { Table } from "./Table";

export const meta = {
  title: "Git merge vs rebase - rÃ³Å¼nice i zastosowania",
  seo_desc:
    "Git merge vs rebase - poznaj rÃ³Å¼nice i zastosowania tych dwÃ³ch kluczowych poleceÅ„ Git.",
  short:
    "Poznaj zawiÅ‚oÅ›ci dwÃ³ch kluczowych, aczkolwiek nietrywialnych poleceÅ„ Gita: git merge i git rebase. Odkryj ich cele, przypadki uÅ¼ycia, typowe bÅ‚Ä™dy i praktyczne wskazÃ³wki, ktÃ³re pomogÄ… Ci w lepszym zarzÄ…dzaniu Twoim kodem.",
  date: "2023-07-17",
  tags: ["Git", "FrontOps"],
};

Dzisiaj wrÃ³cimy do tematÃ³w zwiÄ…zanych z kontrolÄ… wersji. Dwa czÄ™sto uÅ¼ywane polecenia - `git merge` i `git rebase`, doÅ›Ä‡ czÄ™sto powodujÄ… problemy ze zrozumieniem ich dziaÅ‚ania. W tym wpisie porÃ³wnamy je do siebie oraz omÃ³wimy ich przypadki uÅ¼ycia.

## Git Merge

`git merge` to polecenie, ktÃ³re integruje zmiany z jednej gaÅ‚Ä™zi do drugiej (gÅ‚Ã³wnie z gaÅ‚Ä™zi typu `feature` do gaÅ‚Ä™zi `master` lub `main`). Jest to powszechna operacja Å‚Ä…czenia kodu, zwÅ‚aszcza gdy nad projektem pracuje wiele osÃ³b.

```bash
# PrzeÅ‚Ä…cz siÄ™ na gaÅ‚Ä…Åº do ktÃ³rej chcesz scaliÄ‡ zmiany
git checkout master

# Scalenie zmian z gaÅ‚Ä™zi feature do gaÅ‚Ä™zi master
git merge feature
```

W powyÅ¼szym scenariuszu wszystkie zmiany wprowadzone w gaÅ‚Ä™zi `feature` zostanÄ… zintegrowane z gaÅ‚Ä™ziÄ… `master`. Git tutaj stworzy niemal zawsze nowego commita, aby poÅ‚Ä…czyÄ‡ zmiany z obydwu gaÅ‚Ä™zi. Ten nowy commit jest znany jako `merge commit`.

Merge commit zachowuje historyczne informacje o rozgaÅ‚Ä™zieniach i pokazujÄ… dokÅ‚adnie, kiedy i gdzie dana gaÅ‚Ä…Åº odbiegÅ‚a od naszej gÅ‚Ã³wnej gaÅ‚Ä™zi. Jest to Å›wietne rozwiÄ…zanie do przechowywania szczegÃ³Å‚owej historii, ale moÅ¼e skutkowaÄ‡ zÅ‚oÅ¼onÄ…, trudnÄ… do analizy i nieliniowÄ… historiÄ… commitÃ³w.

<Figure
  src="/blog/git-merge-vs-rebase/merge.png"
  alt="Git Merge przedstawiony graficznie"
  caption="Å¹rÃ³dÅ‚o: https://www.atlassian.com/git/tutorials/using-branches/git-merge"
/>

## Git Rebase

Z kolei `git rebase` to kolejny sposÃ³b na integracjÄ™ zmian z jednej gaÅ‚Ä™zi do drugiej, ale dziaÅ‚a on nieco inaczej. Zamiast tworzyÄ‡ nowy merge commit, `git rebase` przenosi lub Å‚Ä…czy commity, tworzÄ…c liniowÄ… historiÄ™ commitÃ³w.

```bash
# PrzeÅ‚Ä…cz siÄ™ na gaÅ‚Ä…Åº, ktÃ³rÄ… chcesz zrebase'owaÄ‡
git checkout feature

# Zrebase'uj zmiany z gaÅ‚Ä™zi master do gaÅ‚Ä™zi feature (czyli aktualizuj gaÅ‚Ä…Åº feature o najnowsze zmiany z gaÅ‚Ä™zi master)
git rebase master
```

W tym przykÅ‚adzie zmiany z gaÅ‚Ä™zi `feature` sÄ… ponownie nakÅ‚adane na gaÅ‚Ä…Åº `master`, a wynikowa historia wyglÄ…da tak, jakby zmiany zostaÅ‚y wprowadzone zaczynajÄ…c od najnowszego commita gaÅ‚Ä™zi `master`.

Rebasing oferuje czystÄ…, liniowÄ… historiÄ™. Jest to doskonaÅ‚e rozwiÄ…zanie w sytuacjach, gdy chcesz, aby gaÅ‚Ä…Åº danego feature-a byÅ‚a aktualna z najnowszym kodem z innej gaÅ‚Ä™zi.

<Figure
  src="/blog/git-merge-vs-rebase/rebase.gif"
  alt="animacja obrazujÄ…ca rebase"
  caption="Å¹rÃ³dÅ‚o: https://blog.mralx.com/git-rebase/"
/>

## ğŸ‘ Kiedy uÅ¼ywaÄ‡ merge, a kiedy rebase?

ZarÃ³wno komenda `git merge`, jak i `git rebase` sÅ‚uÅ¼Ä… pewnemu konkretnemu celowi. W zaleÅ¼noÅ›ci od sytuacji naleÅ¼y wybraÄ‡ jednÄ… z nich.

### UÅ¼yj merge, gdy:

Chcesz poÅ‚Ä…czyÄ‡ kod z dwÃ³ch rÃ³Å¼nych gaÅ‚Ä™zi i zachowaÄ‡ dokÅ‚adny zapis historyczny. Merge sÄ… przydatne do integracji gaÅ‚Ä™zi dÅ‚ugo Å¼yjÄ…cych (_long-lived feature branch_) z powrotem do gÅ‚Ã³wnego kodu (gaÅ‚Ä™zi `master`, `main` lub `develop`).

### UÅ¼yj _rebase_, gdy:

Pracujesz nad gaÅ‚Ä™ziÄ… funkcji i musisz wÅ‚Ä…czyÄ‡ najnowsze zmiany z gÅ‚Ã³wnej gaÅ‚Ä™zi. Rebasing pomaga zachowaÄ‡ aktualnoÅ›Ä‡ naszej gaÅ‚Ä™zi bez zaÅ›miecania historii commitÃ³w niepotrzebnymi merge commitami.

## ğŸ‘ Kiedy NIE uÅ¼ywaÄ‡ merge i rebase

Tak jak majÄ… swoje przypadki uÅ¼ycia, git merge i git rebase majÄ… rÃ³wnieÅ¼ sytuacje, w ktÃ³rych nie sÄ… najlepszym wyborem.

### Unikaj merge, gdy:

Masz do czynienia z krÃ³tkotrwaÅ‚Ä… gaÅ‚Ä™ziÄ… i chcesz mieÄ‡ czystÄ…, liniowÄ… historiÄ™. Wielokrotne scalenia w krÃ³tkim odstÄ™pie czasu mogÄ… sprawiÄ‡, Å¼e historia commitÃ³w bÄ™dzie trudna do zrozumienia.

### Unikaj rebase, gdy:

Masz do czynienia z publicznÄ…, wspÃ³Å‚dzielonÄ… gaÅ‚Ä™ziÄ…, na ktÃ³rej inni mogli oprzeÄ‡ swojÄ… pracÄ™. Rebase przepisuje historiÄ™ commitÃ³w, co moÅ¼e powodowaÄ‡ konflikty i problemy dla innych deweloperÃ³w.

## Przydatne wskazÃ³wki

MajÄ…c za sobÄ… jasne zrozumienie `git merge` i `git rebase`, zanurzmy siÄ™ gÅ‚Ä™biej i poznajmy kilka przydatnych wskazÃ³wek, ktÃ³re mogÄ… usprawniÄ‡ nam pracÄ™ z tymi poleceniami.

### Merge

- UÅ¼yj `--no-ff`, aby zachowaÄ‡ gaÅ‚Ä™zie funkcji: Git domyÅ›lnie czasami wykonuje szybkie scalanie i usuwa informacje o istnieniu feature brancha. JeÅ›li chcesz zachowaÄ‡ historiÄ™ swoich feature branchy, uÅ¼yj opcji `--no-ff`.

  ```bash
  git merge --no-ff feature
  ```

- MÄ…drze rozwiÄ…zuj konflikty: Gdy napotkasz konflikt podczas mergowania, Git pozostawi znaczniki (`<<<<`, `====`, `>>>>`) w skonfliktowanych plikach. CzÄ™Å›Ä‡ miÄ™dzy `<<<<` i `====` pochodzi z bieÅ¼Ä…cej gaÅ‚Ä™zi, a czÄ™Å›Ä‡ miÄ™dzy `====` i `>>>>` pochodzi z gaÅ‚Ä™zi, ktÃ³rÄ… prÃ³bujesz scaliÄ‡.

- UÅ¼yj `git mergetool`: JeÅ›li nie czujesz siÄ™ komfortowo podczas rÄ™cznego rozwiÄ…zywania konfliktÃ³w scalania, moÅ¼esz uÅ¼yÄ‡ narzÄ™dzia [mergetool](https://git-scm.com/docs/git-mergetool), ktÃ³re zapewnia graficzny interfejs do rozwiÄ…zywania konfliktÃ³w.

### Rebase

- Interaktywny rebase: UÅ¼yj interaktywnego rebase (`-i` lub `--interactive`), aby scaliÄ‡ wiele commitÃ³w w jeden, usunÄ…Ä‡ niechciane commity lub zmieniÄ‡ tytuÅ‚y commitÃ³w, co jest niezwykle pomocne w utrzymaniu czystej, czytelnej historii commitÃ³w.

  ```bash
  git rebase -i HEAD~3
  ```

  Spowoduje to otwarcie trzech ostatnich commitÃ³w w wybranym edytorze tekstu, umoÅ¼liwiajÄ…c wybranie tych, ktÃ³re majÄ… zostaÄ‡ zmienione, scalone lub odrzucone.

- UÅ¼yj `autosquash` z `rebase -i`: JeÅ›li planujesz scaliÄ‡ w jeden commit kilka rÃ³Å¼nych commitÃ³w podczas interaktywnego `rebase`, moÅ¼esz zautomatyzowaÄ‡ ten proces, uÅ¼ywajÄ…c `--autosquash`.

  ```bash
  git rebase -i --autosquash master
  ```

- Przerwanie rebase: JeÅ›li rebase pÃ³jdzie Åºle lub nie jesteÅ› pewien zmian, moÅ¼esz przerwaÄ‡ operacjÄ™ rebase i powrÃ³ciÄ‡ do stanu sprzed jej rozpoczÄ™cia za pomocÄ… `git rebase --abort`.

- UÅ¼yj `rerere`, aby zapamiÄ™taÄ‡ rozwiÄ…zania konfliktÃ³w: `rerere` oznacza "_reuse recorded resolution_" i jest sposobem, aby Git zapamiÄ™taÅ‚, w jaki sposÃ³b rozwiÄ…zaÅ‚eÅ› konflikt. WiÄ™c nastÄ™pnym razem, gdy zobaczy ten sam konflikt, Git moÅ¼e automatycznie rozwiÄ…zaÄ‡ go za Ciebie.

  WÅ‚Ä…cz za pomocÄ… `git config --global rerere.enabled true`

## NajczÄ™stsze bÅ‚Ä™dy

PamiÄ™tajmy, Å¼e jak kaÅ¼de narzÄ™dzie, poznane przez nas polecenia mogÄ… przynieÅ›Ä‡ niepoÅ¼Ä…dane rezultaty, jeÅ›li zostanÄ… niewÅ‚aÅ›ciwie uÅ¼yte. RzuÄ‡my okiem na kilka typowych bÅ‚Ä™dÃ³w popeÅ‚nianych przez deweloperÃ³w za pomocÄ… `git merge` i `git rebase` oraz sposoby ich unikniÄ™cia.

### Merge

- Mergowanie bez commitu: Jednym z czÄ™stych bÅ‚Ä™dÃ³w jest prÃ³ba mergowania gaÅ‚Ä™zi, gdy w bieÅ¼Ä…cej gaÅ‚Ä™zi znajdujÄ… siÄ™ niezacommitowane zmiany. MoÅ¼e to prowadziÄ‡ do konfliktÃ³w, ktÃ³rych moÅ¼na by uniknÄ…Ä‡, gdybyÅ›my po prostu zrobili commit zmiany przed scaleniem.

  âœ… Zawsze upewnij siÄ™, Å¼e zacommitowaÅ‚eÅ› wszelkie wprowadzone zmiany przed scaleniem innej gaÅ‚Ä™zi z bieÅ¼Ä…cÄ….

- Scalanie niewÅ‚aÅ›ciwych gaÅ‚Ä™zi: Brzmi to oczywisto, ale zdarza siÄ™ czÄ™Å›ciej, niÅ¼ mogÅ‚oby siÄ™ wydawaÄ‡, zwÅ‚aszcza gdy czÄ™sto przeÅ‚Ä…czasz siÄ™ miÄ™dzy wieloma gaÅ‚Ä™ziami funkcji.

  âœ… Zawsze sprawdzaj, w ktÃ³rej gaÅ‚Ä™zi aktualnie siÄ™ znajdujesz przed wykonaniem operacji scalania. MoÅ¼na to zrobiÄ‡ za pomocÄ… `git branch` lub `git status`.

- Pozostawianie nierozwiÄ…zanych konfliktÃ³w: Git nie ukoÅ„czy operacji mergowania, jeÅ›li istniejÄ… konflikty miÄ™dzy gaÅ‚Ä™ziami, ktÃ³rych nie moÅ¼e rozwiÄ…zaÄ‡ automatycznie. Konflikty te pozostajÄ… w plikach, ktÃ³rych dotyczÄ… i mogÄ… spowodowaÄ‡, Å¼e projekt nie bÄ™dzie dziaÅ‚aÅ‚ zgodnie z oczekiwaniami.

  âœ… Zawsze rozwiÄ…zuj wszystkie konflikty, gdy tylko siÄ™ pojawiÄ…. Git poinformuje CiÄ™, ktÃ³re pliki majÄ… konflikty i ktÃ³re musisz rozwiÄ…zaÄ‡ rÄ™cznie. NastÄ™pnie moÅ¼na otworzyÄ‡ te pliki w edytorze tekstu i zdecydowaÄ‡ dla kaÅ¼dego konfliktu, ktÃ³ry kod naleÅ¼y zachowaÄ‡.

### Rebase

- Rebasowanie gaÅ‚Ä™zi publicznych: NajczÄ™stszym i potencjalnie katastrofalnym bÅ‚Ä™dem jest rebase gaÅ‚Ä™zi, ktÃ³re zostaÅ‚y wypchniÄ™te do publicznego repozytorium. PoniewaÅ¼ rebase przepisuje historiÄ™ commitÃ³w, moÅ¼e to tworzyÄ‡ sprzeczne historie i dezorientowaÄ‡ innych programistÃ³w pracujÄ…cych nad projektem.

  âœ… Wykonuj rebase tylko lokalnych gaÅ‚Ä™zi, ktÃ³re nie zostaÅ‚y wypchniÄ™te do publicznego repozytorium. Gdy gaÅ‚Ä…Åº zostanie upubliczniona, uÅ¼yj `merge` zamiast `rebase`.

- Brak natychmiastowej obsÅ‚ugi konfliktÃ³w: Podczas rebase, jeÅ›li nie obsÅ‚uÅ¼ysz konfliktu natychmiast i uruchomisz `git rebase --continue`, moÅ¼esz straciÄ‡ pracÄ™ nad rozwiÄ…zywaniem konfliktÃ³w.

  âœ… Zawsze rozwiÄ…zuj konflikty natychmiast po ich wystÄ…pieniu podczas rebase, a nastÄ™pnie uÅ¼yj `git add`, aby umieÅ›ciÄ‡ rozwiÄ…zane pliki przed uruchomieniem `git rebase --continue`.

- UÅ¼ywanie rebase, gdy merge jest bardziej odpowiednie: Czasami deweloperzy uÅ¼ywajÄ… rebase, gdy powinni uÅ¼ywaÄ‡ merge. Powoduje to liniowÄ… historiÄ™ commitÃ³w, ale kosztem utraty kontekstu zapewnianego przez merge commit.

  âœ… JeÅ›li wielu deweloperÃ³w pracuje razem nad funkcjÄ… lub jeÅ›li chcesz zachowaÄ‡ kontekst gaÅ‚Ä™zi, uÅ¼yj merge zamiast rebase.

Kluczem do unikniÄ™cia bÅ‚Ä™dÃ³w z `git merge` i `git rebase` jest zrozumienie dziaÅ‚ania tych poleceÅ„ i ich wpÅ‚ywu na historiÄ™ commitÃ³w. DziÄ™ki przemyÅ›lanemu podejÅ›ciu do mergowania i rebasowania moÅ¼na zachowaÄ‡ czystÄ… historiÄ™ commitÃ³w, jednoczeÅ›nie minimalizujÄ…c zamieszanie w zespole.

Jak zawsze nie bÃ³j siÄ™ eksperymentowaÄ‡ i popeÅ‚niaÄ‡ bÅ‚Ä™dÃ³w, poniewaÅ¼ sÄ… one czÄ™Å›ciÄ… procesu uczenia siÄ™. PamiÄ™taj, Å¼e kaÅ¼dy bÅ‚Ä…d jest okazjÄ… do nauczenia siÄ™ czegoÅ› nowego i nie myli siÄ™ tylko ten, ktÃ³ry nic nie robi ğŸ’ª

## PorÃ³wnanie

Zbiorcze porÃ³wnanie omawianych przez nas poleceÅ„.

<Table />

## Podsumowanie

Zrozumienie `git merge` i `git rebase` jest kluczowe dla efektywnej wspÃ³Å‚pracy i utrzymania czystej bazy kodu. Podczas gdy oba polecenia mogÄ… integrowaÄ‡ zmiany z jednej gaÅ‚Ä™zi do drugiej, robiÄ… to na rÃ³Å¼ne sposoby i sÅ‚uÅ¼Ä… rÃ³Å¼nym celom.

PamiÄ™taj, Å¼e nie chodzi o to, ktÃ³re z nich jest lepsze â€” chodzi o to, ktÃ³re jest bardziej odpowiednie w danej sytuacji. DziÄ™ki jasnemu zrozumieniu obu poleceÅ„ moÅ¼esz teraz dokonaÄ‡ wÅ‚aÅ›ciwego wyboru dla swojego projektu.
