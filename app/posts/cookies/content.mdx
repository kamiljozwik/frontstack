export const meta = {
  title: "Cookies - przewodnik dla programistÃ³w frontendowych",
  seo_desc:
    "Poznaj pliki cookies i dowiedz siÄ™ jak mogÄ… pomÃ³c programistom frontendowym w tworzeniu stron internetowych.",
  short:
    "Poznaj Å›wiat plikÃ³w ğŸª cookie w komunikacji klient-serwer. Dowiedz siÄ™, w jaki sposÃ³b poprawiajÄ… one wraÅ¼enia uÅ¼ytkownika, jakie sÄ… najlepsze praktyki w zakresie bezpiecznego korzystania z nich i jak wypadajÄ… one w porÃ³wnaniu z Local Storage. Spraw, aby Twoje witryny byÅ‚y bezpieczniejsze i bardziej przyjazne dla uÅ¼ytkownika.",
  date: "2023-07-16",
  tags: ["JavaScript", "Inne"],
};

Dzisiaj zapoznamy siÄ™ z jednym z podstawowych elementÃ³w komunikacji klient-serwer, czyli plikami ğŸª cookie. Nie, nie sÄ… to pyszne smakoÅ‚yki, ktÃ³re od razu przychodzÄ… na myÅ›l. SÄ… to raczej maÅ‚e fragmenty informacji przechowywane po stronie klienta w celu poprawy doÅ›wiadczenia uÅ¼ytkownika i interakcji ze stronami i aplikacjami internetowymi. OdgrywajÄ… one dzisiaj doÅ›Ä‡ istotnÄ… rolÄ™ w Internecie, a jako programiÅ›ci frontendowi moÅ¼emy nimi manipulowaÄ‡ na naszÄ… korzyÅ›Ä‡.

## Czym sÄ… pliki cookie?

W kontekÅ›cie tworzenia stron internetowych plik cookie to niewielki fragment danych przechowywany na komputerze uÅ¼ytkownika przez przeglÄ…darkÄ™ internetowÄ… podczas przeglÄ…dania strony. Pliki cookie zostaÅ‚y zaprojektowane jako mechanizm dla stron internetowych do zapamiÄ™tywania informacji specyficznych dla uÅ¼ytkownika lub rejestrowania aktywnoÅ›ci przeglÄ…dania uÅ¼ytkownika.

Pliki cookie skÅ‚adajÄ… siÄ™ z jednej lub wiÄ™cej par nazwa-wartoÅ›Ä‡ zawierajÄ…cych fragmenty informacji, ktÃ³re mogÄ… byÄ‡ zaszyfrowane w celu zapewnienia prywatnoÅ›ci informacji i bezpieczeÅ„stwa danych.

## Dlaczego uÅ¼ywamy plikÃ³w cookie?

Pliki cookie mogÄ… sÅ‚uÅ¼yÄ‡ wielu celom, takim jak:

- ZarzÄ…dzanie sesjami: pliki cookie pozwalajÄ… witrynom internetowym rozpoznawaÄ‡ uÅ¼ytkownikÃ³w i zapamiÄ™tywaÄ‡ ich indywidualne preferencje, takie jak zawartoÅ›Ä‡ koszyka lub identyfikator dostÄ™pu do witryny.
- Personalizacja: strony internetowe wykorzystujÄ… pliki cookie do personalizacji doÅ›wiadczeÅ„ uÅ¼ytkownikÃ³w poprzez dostosowanie prezentacji strony, ukÅ‚adu lub opcji dla kaÅ¼dego uÅ¼ytkownika (np. tryb jasny/ciemny).
- Åšledzenie: pliki cookie mogÄ… Å›ledziÄ‡ zachowanie uÅ¼ytkownikÃ³w na stronie internetowej, pomagajÄ…c wÅ‚aÅ›cicielom witryn zrozumieÄ‡ preferencje uÅ¼ytkownikÃ³w w zakresie ukierunkowanego marketingu lub analiz.

Jak widaÄ‡ wiÄ™c, pliki cookie sÄ… caÅ‚kiem przydatne.

## Jak dziaÅ‚ajÄ… pliki cookie?

Pliki cookie sÄ… przechowywane w przeglÄ…darce internetowej uÅ¼ytkownika. Kiedy uÅ¼ytkownik odwiedza stronÄ™ internetowÄ…, serwer wysyÅ‚a plik cookie do przeglÄ…darki, a nastÄ™pnie przeglÄ…darka zapisuje go na komputerze uÅ¼ytkownika. W dalszej czÄ™Å›ci artykuÅ‚u zobaczymy jak moÅ¼emy manipulowaÄ‡ plikami cookies za pomocÄ… JavaScript. KaÅ¼dy plik cookie jest unikalny dla danej witryny internetowej, wiÄ™c nie moÅ¼emy dzieliÄ‡ ich miÄ™dzy rÃ³Å¼nymi witrynami, podobnie jak ma to miejsce w przypadku `local storage` i `session storage`.

Kiedy uÅ¼ytkownik ponownie odwiedza tÄ™ samÄ… stronÄ™ internetowÄ…, przeglÄ…darka wysyÅ‚a (zawszeâ—) pliki cookie z powrotem do serwera, aby poinformowaÄ‡ go o poprzednich aktywnoÅ›ciach uÅ¼ytkownika. Na przykÅ‚ad, jeÅ›li uÅ¼ytkownik zaloguje siÄ™ na stronie internetowej, serwer moÅ¼e wysÅ‚aÄ‡ plik cookie z unikalnym identyfikatorem sesji, ktÃ³ry moÅ¼e byÄ‡ uÅ¼ywany do Å›ledzenia sesji uÅ¼ytkownika. Pliki cookie mogÄ… byÄ‡ rÃ³wnieÅ¼ uÅ¼ywane do Å›ledzenia aktywnoÅ›ci uÅ¼ytkownika, takich jak klikniÄ™cia przyciskÃ³w, przeglÄ…dane strony i inne zachowania.

## Jak programiÅ›ci frontendowi mogÄ… korzystaÄ‡ z plikÃ³w cookie?

Jako programista frontendowy moÅ¼esz uÅ¼ywaÄ‡ plikÃ³w cookie do rÃ³Å¼nych zadaÅ„, w tym:

- Uwierzytelnianie uÅ¼ytkownikÃ³w: pliki cookie mogÄ… byÄ‡ wykorzystywane do uwierzytelniania uÅ¼ytkownikÃ³w. Po udanym logowaniu serwer moÅ¼e wysÅ‚aÄ‡ nagÅ‚Ã³wek `Set-Cookie`, aby zapisaÄ‡ informacje o logowaniu uÅ¼ytkownika.
- Przechowywanie preferencji uÅ¼ytkownika: pliki cookie mogÄ… przechowywaÄ‡ niewielkie iloÅ›ci danych w celu zapamiÄ™tania preferencji uÅ¼ytkownika i spersonalizowania strony internetowej w oparciu o te preferencje.
- Åšledzenie zachowania uÅ¼ytkownika: pliki cookie mogÄ… Å›ledziÄ‡ strony odwiedzane przez uÅ¼ytkownika, klikane przez niego przyciski i inne zachowania, co moÅ¼e pomÃ³c zrozumieÄ‡ nawyki uÅ¼ytkownika i poprawiÄ‡ jego wraÅ¼enia.

Przyjrzyjmy siÄ™, jak tworzyÄ‡, uzyskiwaÄ‡ dostÄ™p i usuwaÄ‡ pliki cookie za pomocÄ… JavaScript:

### Tworzenie plikÃ³w cookie

Plik cookie w wiÄ™kszoÅ›ci przypadkÃ³w bÄ™dÄ… tworzone na serwerze, ale moÅ¼na utworzyÄ‡ je rÃ³wnieÅ¼ przy uÅ¼yciu wÅ‚aÅ›ciwoÅ›ci `document.cookie`:

```js
document.cookie =
  "username=John Doe; expires=Thu, 18 Dec 2023 12:00:00 UTC; path=/";
```

Tutaj utworzyliÅ›my plik cookie o nazwie `username` z wartoÅ›ciÄ… `John Doe`. Cookies moÅ¼emy podejrzeÄ‡ w DevToolsach w zakÅ‚adce "Application". Atrybut `expires` ustawia datÄ™ wygaÅ›niÄ™cia w formacie UTC, po ktÃ³rej plik cookie zostanie usuniÄ™ty. Atrybut `path` okreÅ›la katalog, dla ktÃ³rego plik cookie jest waÅ¼ny. W tym przypadku jest on waÅ¼ny dla wszystkich stron (`/`).

<img
  src="/blog/cookies/devtools.webp"
  alt="screen pokazujacy lokalizacje plikÃ³w cookie w DevTools"
/>

### Uzyskiwanie dostÄ™pu do plikÃ³w cookie

DostÄ™p do plikÃ³w cookie powiÄ…zanych z witrynÄ… moÅ¼na uzyskaÄ‡ przy uÅ¼yciu tej samej wÅ‚aÅ›ciwoÅ›ci `document.cookie`. Ta wÅ‚aÅ›ciwoÅ›Ä‡ zwrÃ³ci wszystkie pliki cookie w jednym ciÄ…gu, np.: `cookie1=wartoÅ›Ä‡; cookie2=wartoÅ›Ä‡; cookie3=wartoÅ›Ä‡;`.

```js
var allCookies = document.cookie;
```

Niestety nie ma wbudowanej metody do uzyskiwania dostÄ™pu do pojedynczych plikÃ³w cookie. MoÅ¼esz jednak napisaÄ‡ funkcjÄ™, ktÃ³ra zwrÃ³ci wartoÅ›Ä‡ pliku cookie o podanej nazwie:

```js
function getCookie(name) {
  var value = "; " + document.cookie;
  var parts = value.split("; " + name + "=");
  if (parts.length == 2) return parts.pop().split(";").shift();
}
```

### Usuwanie plikÃ³w cookie

Aby usunÄ…Ä‡ plik cookie, wystarczy ustawiÄ‡ jego atrybut expires na datÄ™ przeszÅ‚Ä…:

```js
document.cookie = "username=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
```

PamiÄ™taj, Å¼e bezpieczeÅ„stwo jest najwaÅ¼niejsze, gdy masz do czynienia z danymi uÅ¼ytkownika. Zawsze uÅ¼ywaj bezpiecznych flag i `HttpOnly` podczas tworzenia plikÃ³w cookie i unikaj przechowywania poufnych informacji takich jak hasÅ‚a, w plikach cookie.

## Najlepsze praktyki dotyczÄ…ce bezpieczeÅ„stwa plikÃ³w cookie

- UÅ¼ywaj bezpiecznych plikÃ³w cookie: zawsze uÅ¼ywaj flagi `Secure` dla plikÃ³w cookie, jeÅ›li Twoja witryna jest obsÅ‚ugiwana przez HTTPS. Zapewni to, Å¼e plik cookie jest wysyÅ‚any tylko przez poÅ‚Ä…czenie HTTPS.
- Ogranicz dostÄ™p do plikÃ³w cookie: uÅ¼yj atrybutu `HttpOnly`, aby uniemoÅ¼liwiÄ‡ dostÄ™p do wartoÅ›ci plikÃ³w cookie za poÅ›rednictwem JavaScript. MoÅ¼e to pomÃ³c w zapobieganiu atakom XSS.
- UÅ¼yj atrybutu `SameSite`: aby pomÃ³c w ochronie przed atakami CSRF, uÅ¼yj atrybutu `SameSite`. Atrybut `SameSite=Strict` jest najlepszÄ… opcjÄ…, jeÅ›li witryna nie musi udostÄ™pniaÄ‡ plikÃ³w cookie w kontekÅ›cie stron trzecich.
- KrÃ³tki czas Å¼ycia plikÃ³w cookie: im dÅ‚uÅ¼szy czas Å¼ycia pliku cookie, tym dÅ‚uÅ¼ej atakujÄ…cy moÅ¼e potencjalnie uÅ¼yÄ‡ skradzionego pliku cookie do podszycia siÄ™ pod uÅ¼ytkownika. Dlatego teÅ¼ czas Å¼ycia plikÃ³w cookie powinien byÄ‡ jak najkrÃ³tszy.
- Nigdy nie przechowuj poufnych informacji: nigdy nie przechowuj poufnych danych w plikach cookie, takich jak hasÅ‚a, dane poufne uÅ¼ytkownika lub informacje o karcie kredytowej. JeÅ›li musisz Å›ledziÄ‡ sesje uÅ¼ytkownikÃ³w, rozwaÅ¼ uÅ¼ycie sesji po stronie serwera.

## PorÃ³wnanie plikÃ³w cookie z pamiÄ™ciÄ… lokalnÄ… i pamiÄ™ciÄ… sesji

W jednym ze wczeÅ›niejszych wpisÃ³w omÃ³wiÅ‚em dokÅ‚adniej czym jest Local Stoarge i Session Storage. Wpis znajdziesz pod tym linkiem: [Czym jest Local Storage i jak go uÅ¼ywaÄ‡?](/blog/czym-jest-local-storage-i-jak-uzywac)

### Pliki cookie:

- MogÄ… przechowywaÄ‡ do 4 KB danych.
- WysyÅ‚ane z kaÅ¼dym Å¼Ä…daniem HTTP, co zwiÄ™ksza obciÄ…Å¼enie.
- Z flagÄ… `Secure`, mogÄ… byÄ‡ uÅ¼ywane tylko przez szyfrowane poÅ‚Ä…czenie.
- MogÄ… byÄ‡ manipulowane zarÃ³wno przez skrypty po stronie serwera jak i klienta.
- MajÄ… wbudowany mechanizm wygaÅ›niÄ™cia.

### PamiÄ™Ä‡ lokalna:

- MoÅ¼e przechowywaÄ‡ do 5MB-10MB danych (zaleÅ¼y od przeglÄ…darki).
- Nie sÄ… wysyÅ‚ane z kaÅ¼dym Å¼Ä…daniem HTTP.
- MoÅ¼na nim manipulowaÄ‡ tylko za pomocÄ… skryptÃ³w po stronie klienta.
- Trwa do momentu wyraÅºnego usuniÄ™cia.

### Session Storage:

- MoÅ¼e przechowywaÄ‡ do 5MB-10MB danych (w zaleÅ¼noÅ›ci od przeglÄ…darki).
- Nie jest wysyÅ‚any z kaÅ¼dym Å¼Ä…daniem HTTP.
- MoÅ¼na nim manipulowaÄ‡ tylko za pomocÄ… skryptÃ³w po stronie klienta.
- Wygasa po zakoÅ„czeniu sesji strony (po zamkniÄ™ciu karty).

KrÃ³tko mÃ³wiÄ…c, podczas gdy pliki cookie doskonale nadajÄ… siÄ™ do przesyÅ‚ania niewielkich iloÅ›ci danych miÄ™dzy klientem a serwerem, pamiÄ™Ä‡ lokalna i pamiÄ™Ä‡ sesji zapewniajÄ… wiÄ™kszÄ… pojemnoÅ›Ä‡ i nie zwiÄ™kszajÄ… narzutu Å¼Ä…dania HTTP. Nie moÅ¼na jednak uzyskaÄ‡ do nich dostÄ™pu po stronie serwera, co moÅ¼e ograniczaÄ‡ ich uÅ¼ycie w zaleÅ¼noÅ›ci od wymagaÅ„ aplikacji.

## Podsumowanie

Pliki cookie sÄ… niezwykle przydatnym narzÄ™dziem w komunikacji klient-serwer. PozwalajÄ… na lepsze doÅ›wiadczenia uÅ¼ytkownikÃ³w i dostarczajÄ… nam cennych informacji o tym, jak uÅ¼ytkownicy wchodzÄ… w interakcje z naszymi stronami internetowymi. Podobnie jak w przypadku wszystkich narzÄ™dzi, muszÄ… byÄ‡ one jednak uÅ¼ywane w sposÃ³b odpowiedzialny i bezpieczny.
